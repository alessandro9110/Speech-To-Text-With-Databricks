# This is a Databricks asset bundle definition for speech_to_text_asset_bundle.
# See https://docs.databricks.com/dev-tools/bundles/index.html for documentation.
bundle:
  name: speech_to_text_asset_bundle
  uuid: 91fad0ff-e27e-4fdf-97f4-4b5e315f9c3d

include:
  - resources/*.yml
  - resources/*/*.yml

artifacts:
  python_artifact:
    type: whl
    build: uv build --wheel

# Variable declarations. These variables are assigned in the dev/prod targets below.
variables:
  catalog:
    description: The catalog to use for Speech To Text With Databrikcs solution.
  schema:
    description: The catalog to use for Speech To Text With Databrikcs solution.
  databricks_host:
    description: The Databricks workspace URL (e.g., https://your-workspace.cloud.databricks.com)
  admin_user_email:
    description: The email address of the admin user for production deployment permissions

targets:
  dev:
    # See also https://docs.databricks.com/dev-tools/bundles/deployment-modes.html.
    presets:
      name_prefix: ${workspace.current_user.short_name}_ # prefix all resource names with dev_user. Whne the 
      pipelines_development: true # set development to true for pipelines
      trigger_pause_status: PAUSED # set pause_status to PAUSED for all triggers and schedules
      jobs_max_concurrent_runs: 10 # set max_concurrent runs to 10 for all jobs
      tags:
        department: finance
    mode: development
    default: true
    workspace:
      host: ${var.databricks_host}
      root_path: /Workspace/Shared/.bundle/${bundle.name}/${bundle.target}
    
    #define variables
    variables:
      catalog: speech_to_text
      schema: dev
    
    # define resouces like: schemas etc.
    resources:
      schemas:
        dev:
          name: dev
          catalog_name: speech_to_text
          comment: 'Schema for development'


  prod:
    presets:
      name_prefix: 'prod_' 
      pipelines_development: false # set development to true for pipelines
      trigger_pause_status: PAUSED # set pause_status to PAUSED for all triggers and schedules
      jobs_max_concurrent_runs: 10 # set max_concurrent runs to 10 for all jobs
      tags:
        department: finance

    mode: production

    workspace:
      host: ${var.databricks_host}
      # We explicitly deploy to /Workspace/Shared to make sure we only have a single copy.
      root_path: /Workspace/Shared/.bundle/${bundle.name}/${bundle.target}

    variables:
      catalog: speech_to_text
      schema: prod
    
        # define resouces like: schemas etc.
    resources:
      schemas:
        prod:
          name: prod
          catalog_name: speech_to_text
          comment: 'Schema for development'
          
    
    permissions:
      - user_name: ${var.admin_user_email}
        level: CAN_MANAGE
